# SLSA Attestation and Supply Chain Security

## Overview

This document describes the Supply Chain Levels for Software Artifacts (SLSA) implementation for the HIPAA Compliance Summarizer project. SLSA is a security framework that ensures the integrity of software artifacts throughout the supply chain.

## SLSA Level 3 Implementation

Our project implements **SLSA Level 3** requirements:

### Build Requirements
- ✅ **Source integrity**: All source code is version controlled in Git
- ✅ **Build service**: GitHub Actions provides our build service
- ✅ **Build isolation**: Each build runs in an isolated environment
- ✅ **Provenance generation**: Automated provenance generation
- ✅ **Provenance distribution**: Provenance distributed with artifacts

### Provenance Requirements
- ✅ **Authenticated**: Provenance is cryptographically signed
- ✅ **Service generated**: Generated by GitHub Actions (trusted service)
- ✅ **Non-falsifiable**: Cannot be forged by build steps
- ✅ **Dependencies complete**: All dependencies recorded in SBOM

### Common Requirements
- ✅ **Security**: All security controls implemented
- ✅ **Access controls**: Repository access properly controlled
- ✅ **Superuser**: No superuser access during builds

## Verification Instructions

### Verify Container Image Attestation

```bash
# Install cosign
curl -O -L "https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64"
chmod +x cosign-linux-amd64
sudo mv cosign-linux-amd64 /usr/local/bin/cosign

# Verify container signature
cosign verify ghcr.io/your-org/hipaa-compliance-summarizer:latest

# Verify SLSA attestation
cosign verify-attestation ghcr.io/your-org/hipaa-compliance-summarizer:latest \
  --type slsaprovenance \
  --certificate-identity-regexp 'https://github\.com/your-org/hipaa-compliance-summarizer/.github/workflows/supply-chain-security\.yml@refs/heads/main' \
  --certificate-oidc-issuer https://token.actions.githubusercontent.com
```

### Verify Python Package Attestation

```bash
# Download package and signature
wget https://github.com/your-org/hipaa-compliance-summarizer/releases/download/v1.0.0/hipaa_compliance_summarizer-1.0.0.tar.gz
wget https://github.com/your-org/hipaa-compliance-summarizer/releases/download/v1.0.0/hipaa_compliance_summarizer-1.0.0.tar.gz.sig

# Verify signature
cosign verify-blob hipaa_compliance_summarizer-1.0.0.tar.gz \
  --signature hipaa_compliance_summarizer-1.0.0.tar.gz.sig \
  --certificate-identity-regexp 'https://github\.com/your-org/hipaa-compliance-summarizer/.github/workflows/supply-chain-security\.yml@refs/tags/v1\.0\.0' \
  --certificate-oidc-issuer https://token.actions.githubusercontent.com
```

### Verify SBOM Integrity

```bash
# Download SBOM
wget https://github.com/your-org/hipaa-compliance-summarizer/releases/download/v1.0.0/sbom.json

# Verify SBOM hash (check against CI logs or release notes)
sha256sum sbom.json

# Validate SBOM format
pip install cyclonedx-python-lib
python -c "from cyclonedx.model.bom import Bom; Bom.from_json(open('sbom.json').read())"
```

## Provenance Information

### Build Environment
- **Builder**: GitHub Actions
- **Build Image**: Ubuntu 22.04 (ubuntu-latest)
- **Python Version**: 3.11
- **Build Tools**: setuptools, build, twine

### Source Information
- **Repository**: https://github.com/your-org/hipaa-compliance-summarizer
- **Commit SHA**: Available in provenance metadata
- **Branch**: main (for releases)
- **Tag**: Semantic versioning (v1.0.0, v1.1.0, etc.)

### Dependencies
Complete dependency information is available in the SBOM:
- Direct dependencies from requirements.txt
- Transitive dependencies with version pins
- Development dependencies from requirements-test.txt
- Build dependencies from pyproject.toml

## Security Guarantees

### What SLSA Level 3 Guarantees
1. **Artifact integrity**: The artifact hasn't been tampered with
2. **Build integrity**: The build process is secure and auditable
3. **Source authenticity**: The source code is from the claimed repository
4. **Dependency transparency**: All dependencies are documented
5. **Reproducible builds**: Builds can be reproduced given the same inputs

### What SLSA Level 3 Does NOT Guarantee
1. **Source code security**: SLSA doesn't validate the security of source code
2. **Dependency security**: Dependencies may have vulnerabilities
3. **Runtime security**: Security issues may occur during execution
4. **Configuration security**: Deployment configuration is outside SLSA scope

## Compliance and Auditing

### Healthcare Compliance (HIPAA)
- SLSA attestation supports HIPAA audit requirements
- Provenance provides complete build audit trail
- Dependencies are tracked for vulnerability management
- Digital signatures ensure artifact integrity

### Audit Trail Components
1. **Git commit history**: Complete source code history
2. **Build logs**: Detailed build execution logs in GitHub Actions
3. **Provenance attestation**: Cryptographically signed build metadata
4. **SBOM**: Complete software bill of materials
5. **Vulnerability scans**: Dependency and container security scans

### Retention Policy
- Git history: Permanent
- Build logs: 90 days (GitHub Actions default)
- Attestations: Permanent (stored in transparency log)
- SBOMs: Permanent (attached to releases)
- Vulnerability scans: 1 year

## Integration with CI/CD

### Automated Checks
- Every commit triggers SLSA provenance generation
- Pull requests include supply chain security checks
- Releases automatically generate and sign attestations
- Vulnerability scans run daily

### Quality Gates
Build fails if:
- Vulnerability scan finds critical issues
- License compliance check fails
- SBOM generation fails
- Provenance generation fails
- Code signing fails

## Incident Response

### Supply Chain Compromise
If a supply chain compromise is suspected:

1. **Immediate Response**
   - Revoke signing keys if compromised
   - Block affected releases
   - Notify users via security advisory

2. **Investigation**
   - Review provenance for affected builds
   - Analyze build logs for anomalies
   - Check Git history for unauthorized changes
   - Validate SBOM against known dependencies

3. **Recovery**
   - Generate new signing keys
   - Rebuild affected artifacts
   - Update attestations
   - Communicate findings to users

### Contact Information
- **Security Team**: security@example.com
- **Emergency Contact**: +1-xxx-xxx-xxxx
- **PGP Key**: Available at keybase.io/example-security

## References and Standards

### SLSA Framework
- [SLSA Specification](https://slsa.dev/spec/v1.0/)
- [SLSA Requirements](https://slsa.dev/spec/v1.0/requirements)
- [GitHub SLSA Generator](https://github.com/slsa-framework/slsa-github-generator)

### Related Standards
- [NIST SSDF](https://csrc.nist.gov/Projects/ssdf): Secure Software Development Framework
- [OpenSSF Scorecards](https://github.com/ossf/scorecard): Open Source Security Foundation metrics
- [CycloneDX](https://cyclonedx.org/): SBOM standard
- [SPDX](https://spdx.dev/): Software Package Data Exchange

### Healthcare Standards
- [HIPAA Security Rule](https://www.hhs.gov/hipaa/for-professionals/security/index.html)
- [NIST 800-66](https://csrc.nist.gov/publications/detail/sp/800-66/rev-1/final): HIPAA Security Implementation
- [FDA Cybersecurity](https://www.fda.gov/medical-devices/digital-health-center-excellence/cybersecurity): Medical device guidance

## Changelog

### v1.0.0 (2024-01-15)
- Initial SLSA Level 3 implementation
- Container image signing with Cosign keyless
- SBOM generation with CycloneDX
- Automated provenance generation

### Future Enhancements
- SLSA Level 4 requirements evaluation
- Hardware security module (HSM) integration
- Enhanced dependency vulnerability scanning
- Automated incident response workflows